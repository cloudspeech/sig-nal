<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="robots" content="noindex, nofollow"/>
    <meta name="description" content=""/>
    <link rel="icon" href="/favicon.png"/>
    <title>Counter Demo | sig-nal</title>
    <script type="module" src="/src/index.js"></script>
  </head>
  <body>
    <div id="counter1">
      <template shadowrootmode="open">
	<h1 !title="counter" .textContent="title">
	  <sig-nal ref="title"></sig-nal>
	</h1>
	<div class="container">
	  <button @click="counter">
	    <sig-nal ref="inc">+</sig-nal>
	  </button>
	  <span .textContent="counter">
	    <sig-nal new="counter" type="number">0</sig-nal>
          </span>
	  <button @click="counter">
	    <sig-nal ref="dec">-</sig-nal>
	  </button>
	</div>
      </template>
    </div>

    <p>Witness how the 2nd counter instance below is independent of the 1st, thanks to shadowRoot scoping!</p>

    <div class="counter2">
      <template shadowrootmode="open">
	<h1 !title="counter">
	  <sig-nal ref="title">Demo Counter 2 | sig-nal</sig-nal>
	</h1>
	<div class="container">
	  <button @click="counter">
	    <sig-nal ref="inc">+</sig-nal>
	  </button>
	  <span .textContent="counter">
	    <sig-nal new="counter" type="number">0</sig-nal>
          </span>
	  <button @click="counter">
	    <sig-nal ref="dec">-</sig-nal>
	  </button>
	</div>
      </template>
    </div>

    <script type="module">
      const {hydrate, rerender} = await customElements.whenDefined("sig-nal");

      hydrate(["div#counter1", "div.counter2"],
      {  title:   { "!title": rerender, ".textContent": ({domNode,name}) => (domNode[name] = document.title) },
         counter: { ".textContent": rerender },
         inc:     { "@click": ({signal}) => signal.value++ },
         dec:     { "@click": ({signal}) => signal.value-- }
      });
    </script>

  </body>
</html>
