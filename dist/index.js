let t,e=[],i=[],n=0,r=-1,s=[],l=[],a=[],o=new FinalizationRegistry(t=>i[t]=null),u=t=>{let e=a[t],i=l[t]();d(e,i)},d=(t,n)=>{i[t]=n;for(let i of s[t]||e){let t=typeof i;"function"===t?i():"number"===t&&u(i)}return n};class c{#t;constructor(){this.#t=++n,o.register(this,n)}get value(){let e=this.#t,n=t;return n?.indexOf(e)<0&&(n.push(e),n.sort()),i[e]}set value(t){return d(this.#t,t)}valueOf=()=>this.value;toString=()=>String(this.value);effect=(t,e)=>((t,e,i)=>{i&&e();let n=s[t]=s[t]||[],r=n.length;return n[r]=e,[t,r]})(this.#t,t,e)}let h=i=>{let n=new c,l=t||e;for(let t;t=l.shift();)s[t]||(s[t]=[]),s[t].push(r);return n.value=i,n},g=e=>{t=[];let i=++r;l[i]=e,a[i]=n+1;let s=h(e());return t=null,s},f=document;class m extends WeakMap{use=(t,e={})=>this.get(t)||this.set(t,e).get(t)}let y=new m,p=new Proxy({},{get:async(t,e)=>(await import("./plugins/"+e+".js")).default}),A=(t,e,i,n,r,s,l)=>{let{getById:a,ctx:o}=t,u=s.getAttribute(i),d=y.get(o.scope),c=d&&d[u||t.name];return u&&queueMicrotask(()=>s.removeAttribute(i)),t=>i=>t({getById:a,ctx:o,name:r,signal:c,signals:d,domNode:s,nodes:l,id:e,kind:n,e:i,plugins:p})},v=(t,e,i,n)=>{if("function"==typeof t&&(t=t()),/^dataset\.\S+$/.test(e))return i.dataset[e.slice(8)]=t;if(null!==t)switch(n){case 1:return i[e]!==t&&(i[e]=t);case 2:return i[t?"setAttribute":"removeAttribute"](e,"");case 3:return i.setAttribute(e,t);case 4:Array.isArray(t)||(t=[t]),i[e](...t)}};class x extends HTMLElement{#e=t=>this.getAttribute(t);static signal=h;static computed=g;static plugin=t=>e=>e.plugins[e.name].then(i=>i(e)(t(e)));static hydrate=t=>e=>{let{getById:i,root:n}=e,r=new Proxy({},{get:(t,e)=>i(e)});for(let s in t){let l=t[s];for(let t in l){let[a,o,u,d={}]=[l[t],t.slice(1),t[0]];Array.isArray(a)&&([a,d]=[a[0],a[1]]);let c="@.?!:".indexOf(u);if(c<0)continue;let h=s?i(s):n,g=A(e,s,t,c,o,h,r)(a);c?g():h.addEventListener(o,g,d)}}};static html=(t,e,i)=>{t instanceof HTMLTemplateElement&&(t=t.content.firstElementChild);let n=Object.keys(e).join(","),r=new Function(n,"return `"+t.outerHTML+"`");return i?r:r(...Object.values(e))};static index=(t,e=t.map(t=>t.slice(1)))=>({getById:i,ctx:{name:n},signal:r})=>(s=r.value)=>{for(let r,l,a,o,u=0,d=0|s?.length;u<d;u++)if(r=s[u],a=Array.isArray(r),l=i(n+u),void 0!==r&&l){o=0;for(let i of t)l.hasAttribute(i)&&(l[e[o]]=a?r[o]:r),o++}};static object=({getById:t,ctx:{name:e},signal:i})=>(n=i.value)=>{for(let i,r,s,l=0,a=0|n?.length;l<a;l++)if(i=n[l],r=t(e+l),void 0!==i&&r)for(let t in i)s=i[t],v(s,t,r,1)};static render=({signal:t,getById:e,id:i,name:n,kind:r})=>(s=t.value,l=e(i))=>v(s,n,l,r);static renderWith=(t,e=!0)=>i=>i.signal.effect(t(i),e);static rerender=x.renderWith(x.render);constructor(){super();let t=this.root=this[this.#e("for")||"parentNode"],e=this.#e("scope");e=e?this.closest(e):this.getRootNode();let i=e instanceof ShadowRoot,n=this.#e("new"),r=(this.name=n)||this.#e("ref")||crypto.randomUUID(),s=this.#e("type"),[l,a]=(this.#e("default")||"").split("#"),{id:o}=this;if(this.getById=i?e=>t.querySelector("#"+e):t=>f.getElementById(t),this.ctx={root:t,scope:e,name:r,type:s,id:o},n){let t=l?this.getById(a)[l.slice(1)]:this.#e("value");y.use(e)[r]=h(((t,e)=>"number"===e?0|t:t)(t,s))}if(null!==this.#e("index")){let e=f.createTreeWalker(t,1),i=0;for(;e.nextNode();){let t=e.currentNode;t!==this&&t.id===r&&(t.id=r+i++)}}if(null!==this.#e("hydrate")){let e=()=>{let i=this.textContent.trim();if(125!==i.charCodeAt(i.length-1))return requestAnimationFrame(e);new Function(`let{hydrate,render,rerender,renderWith,index,object,plugin,computed,html}=customElements.get('sig-nal');return hydrate(${i})`)()(this),t.dispatchEvent(new Event("init")),this.className||this.remove()};e()}}}customElements.define("sig-nal",x);
